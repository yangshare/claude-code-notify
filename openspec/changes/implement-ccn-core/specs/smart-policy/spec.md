## 新增需求

### 需求：智能阈值过滤
系统必须根据任务执行时间决定是否发送通知。

#### 场景：任务时间低于阈值且成功
- **当** 任务耗时 8 秒，状态为 success，配置的 `min_duration` 为 10 秒
- **那么** 必须过滤该通知，不发送

#### 场景：任务时间低于阈值但失败
- **当** 任务耗时 5 秒，状态为 error
- **那么** 必须强制发送通知，忽略阈值设置

#### 场景：任务时间高于阈值
- **当** 任务耗时 15 秒，状态为 success
- **那么** 必须发送通知

#### 场景：配置默认阈值
- **当** 用户未配置 `min_duration`
- **那么** 必须使用默认值 10 秒

### 需求：白名单命令
系统必须支持白名单功能，特定命令无论耗时多久都必须通知。

#### 场景：白名单命令快速完成
- **当** 命令为 "deploy"，耗时 3 秒，且在白名单中
- **那么** 必须发送通知

#### 场景：白名单命令失败
- **当** 白名单命令执行失败
- **那么** 必须发送错误通知

#### 场景：配置白名单
- **当** 用户在配置文件中设置 `threshold.whitelist = ["deploy", "release"]`
- **那么** 系统必须识别这些命令并始终发送通知

### 需求：通知摘要聚合
系统必须在短时间内连续触发多条通知时自动聚合。

#### 场景：聚合多条成功通知
- **当** 5 秒内连续触发 3 条成功通知
- **那么** 必须聚合为一条："3个任务已完成 (总耗时: 45s)"

#### 场景：聚合混合状态通知
- **当** 5 秒内触发 5 条通知（3 成功，2 失败）
- **那么** 必须聚合为："5个任务已完成 (3成功, 2失败)"

#### 场景：超过聚合窗口
- **当** 通知间隔超过聚合窗口时间（默认 5 秒）
- **那么** 必须分别发送独立通知，不聚合

#### 场景：禁用聚合功能
- **当** 用户设置 `aggregation.enabled = false`
- **那么** 必须禁用聚合，每条通知独立发送

### 需求：场景化模板配置
系统必须支持根据命令类型使用不同的通知模板。

#### 场景：匹配构建场景模板
- **当** 命令包含 "build" 或 "compile"
- **那么** 必须使用 `templates.build` 配置的图标和声音

#### 场景：匹配测试场景模板
- **当** 命令包含 "test" 或 "spec"
- **那么** 必须使用 `templates.test` 配置的图标和声音

#### 场景：未匹配场景使用默认模板
- **当** 命令不匹配任何场景
- **那么** 必须使用 `templates.default` 配置

#### 场景：自定义场景模板
- **当** 用户在配置文件中添加自定义场景 `templates.deploy`
- **那么** 系统必须能够识别并应用该模板

### 需求：通知优先级
系统必须根据通知类型和状态设置适当的优先级。

#### 场景：错误通知高优先级
- **当** 通知状态为 error
- **那么** 必须设置为高优先级，确保在通知中心置顶显示

#### 场景：成功通知普通优先级
- **当** 通知状态为 success
- **那么** 必须设置为普通优先级

#### 场景：聚合通知优先级
- **当** 聚合的通知中包含任何错误
- **那么** 聚合通知必须使用高优先级

### 需求：通知去重
系统必须避免在短时间内发送重复的通知。

#### 场景：相同命令短时间重复
- **当** 相同命令在 2 秒内重复触发
- **那么** 必须忽略后续重复通知

#### 场景：相同状态重复通知
- **当** 相同命令和状态的通知在去重窗口内重复
- **那么** 必须更新现有通知而不是发送新通知
